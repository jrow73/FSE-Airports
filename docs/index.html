<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FSE Airport Map Viewer</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <link rel="stylesheet" href="./css/styles.css" />
</head>
<body>
  <div id="app">
    <!-- Top header bar -->
    <header class="topbar">
      <div class="top-left">
        <span class="app-title">Airports</span>
        <span id="loading" class="loading hidden">Loading…</span>
      </div>

      <div class="top-center">
        <div class="search-wrap">
          <input
            id="searchInput"
            class="search"
            type="search"
            placeholder="Search ICAO, Airport Name, City, or lat/lon (Press Enter)"
            autocomplete="off"
          />
        </div>
      </div>

      <div class="top-right">
        <button id="filtersBtn" class="menu-btn" aria-expanded="false">Filters ▾</button>
        <button id="distanceBtn" class="menu-btn" aria-expanded="false">Distance ▾</button>
      </div>

    </header>

   
    <!-- Slide-down filters panel -->
    <section id="filtersPanel" class="panel" aria-hidden="true">
      <div class="panel-inner">

        <!-- Regional filters -->
        <div class="filter-section">
          <button
            type="button"
            class="filter-section-header"
            aria-expanded="true"
          >
            <span>Regional filters</span>
            <span class="filter-section-header-icon">▾</span>
          </button>
          <div class="filter-section-body">
            <div class="grid filters-grid">

              <!-- Country -->
              <div class="field field-tall">
                <label for="countrySelect">Country</label>
                <select id="countrySelect" multiple size="20">
                  <option value="">All</option>
                </select>
              </div>

              <!-- State -->
              <div class="field field-tall">
                <label for="stateSelect">State</label>
                <select id="stateSelect" multiple size="20">
                  <option value="">All</option>
                </select>
              </div>

              <!-- Radius -->
              <div class="field field-compact">
                <label class="inline-label" for="radiusCenter">Radius center / (nm)</label>
                <div class="inline-group">
                  <input
                    id="radiusCenter"
                    type="text"
                    autocomplete="off"
                    placeholder="ICAO or lat/lon"
                  />
                  <input
                    id="radiusNm"
                    type="number"
                    inputmode="numeric"
                    min="1"
                    step="10"
                    placeholder="nm"
                  />
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- Runway filters -->
        <div class="filter-section">
          <button
            type="button"
            class="filter-section-header"
            aria-expanded="true"
          >
            <span>Runway filters</span>
            <span class="filter-section-header-icon">▾</span>
          </button>
          <div class="filter-section-body">
            <div class="grid filters-grid">

              <!-- Runway length -->
              <div class="field field-compact">
                <label>Runway (ft)</label>
                <div class="inline-group">
                  <input
                    id="rwyMin"
                    type="number"
                    inputmode="numeric"
                    min="0"
                    step="500"
                    placeholder="Min"
                  />
                  <span class="inline-separator">/</span>
                  <input
                    id="rwyMax"
                    type="number"
                    inputmode="numeric"
                    min="0"
                    step="500"
                    placeholder="Max"
                  />
                </div>
              </div>

              <!-- Surface type -->
              <div class="field field-compact">
                <label for="surfaceSelect" class="stack-label">Surface Type</label>
                <select id="surfaceSelect" multiple size="6">
                  <option value="">All</option>
                </select>
              </div>

            </div>
          </div>
        </div>

        <!-- Airport features -->
        <div class="filter-section">
          <button
            type="button"
            class="filter-section-header"
            aria-expanded="true"
          >
            <span>Airport features</span>
            <span class="filter-section-header-icon">▾</span>
          </button>
          <div class="filter-section-body">
            <div class="grid filters-grid">

              <!-- Type -->
              <div class="field field-compact">
                <label for="typeSelect">Type</label>
                <select id="typeSelect" multiple size="4">
                  <option value="">All</option>
                  <option value="civil">Civil</option>
                  <option value="military">Military</option>
                  <option value="water">Water</option>
                </select>
              </div>

              <!-- Size -->
              <div class="field field-compact">
                <label for="sizeSelect" class="stack-label">Size</label>
                <select id="sizeSelect" multiple size="4">
                  <option value="">All</option>
                  <option value="small">Small</option>
                  <option value="medium">Medium</option>
                  <option value="large">Large</option>
                </select>
              </div>

              <!-- IRL / Local services -->
              <div class="field field-compact">
                <label for="irlStatus" class="stack-label">IRL airport</label>
                <select id="irlStatus" multiple size="4">
                  <option value="any">Any</option>
                  <option value="correct">FSE ICAO = IRL ICAO</option>
                  <option value="incorrect">FSE ICAO ≠ IRL ICAO</option>
                  <option value="none">No IRL airport</option>
                </select>

                <label class="stack-label">Local services</label>
                <div class="inline-group">
                  <label class="inline">
                    <input type="checkbox" id="localFuel" />
                    Fuel
                  </label>
                  <label class="inline">
                    <input type="checkbox" id="localMx" />
                    Fuel & MX
                  </label>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="panel-actions">
          <div class="panel-count">
            <div id="count" class="count"></div>
            <button id="copyIcaos" class="ghost copy-btn" disabled>Copy ICAOs</button>
          </div>
          <div class="panel-buttons">
            <button id="filtersClear" class="ghost">Clear All</button>
            <button id="filtersClose">Show Map</button>
          </div>
        </div>
      </div>
    </section>



    <!-- Distance panel -->
    <section id="distancePanel" class="panel" aria-hidden="true">
      <div class="panel-inner">
        <div class="grid">
          <div class="field">
            <label for="distFrom">From ICAO</label>
            <input
              id="distFrom"
              type="text"
              maxlength="32"
              autocomplete="off"
              placeholder="ICAO or lat lon"
            />
          </div>

          <div class="field">
            <label for="distTo">To ICAO</label>
            <input
              id="distTo"
              type="text"
              maxlength="32"
              autocomplete="off"
              placeholder="ICAO or lat lon"
            />
          </div>
        </div>

        <div class="panel-actions">
          <div id="distanceResult" class="count"></div>
          <div class="panel-buttons">
            <button id="distanceGo">Compute</button>
            <button id="distanceSwap" class="ghost">Swap</button>
            <button id="distanceClear" class="ghost">Clear</button>
            <button id="distanceClose">Close</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Map fills the rest -->
    <main id="map"></main>
  </div>

  <!-- Leaflet core -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <!-- Leaflet.glify browser build -->
  <script src="https://cdn.jsdelivr.net/npm/leaflet.glify@3.3.1/dist/glify-browser.js"></script>

  <!-- local app modules -->
  <script src="./js/map.js"></script>
  <script src="./js/gl-renderer.js"></script>
  <script src="./js/search.js"></script>
  <script src="./js/geo-utils.js"></script>
  <script src="./js/query-ui.js"></script>
  <script src="./js/distance-tool.js"></script>
  <script src="./js/app.js"></script>
</body>
</html>
